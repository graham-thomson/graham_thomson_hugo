<!doctype html>
<html>
<head>
    <base href="/">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="author" content="">

<meta name="description" content="">

<title>List of Lists</title>
<meta name="generator" content="Hugo 0.55.6" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/pojoaque.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
<link  href="http://grahamflemingthomson.com/css/theme.min.css" rel="stylesheet" type="text/css">

</head>
<body>
<div class="page-container container-fluid">
<div class="col-md-3 menu">
    <nav class="col-md-3">
    
    <h3 class="home-link"><a href="http://grahamflemingthomson.com">Root</a></h3>
    <div id="last-posts" class="open">
        <h3 data-open="last-posts">Graham Thomson - Most recent posts</h3>
        <ul>
            
            <li><a href="http://grahamflemingthomson.com/posts/scala_udfs/">Using Scala UDFs in PySpark</a></li>
            
            <li><a href="http://grahamflemingthomson.com/posts/list-of-lists/">List of Lists</a></li>
            
            <li><a href="http://grahamflemingthomson.com/posts/spark-s3a/">Spark &#43; s3a:// = ❤️</a></li>
            
            <li><a href="http://grahamflemingthomson.com/posts/cosine-similarity-spark/">Cosine Similarity Spark</a></li>
            
            <li><a href="http://grahamflemingthomson.com/posts/resume/">Resume</a></li>
            
        </ul>
    </div>
    

    
    <div id="tags" class="open">
        <h3 data-open="tags">Tags</h3>
        <ul class="tags">
            
            <li><a href="/tags/apache">apache</a></li>
            
            <li><a href="/tags/blog">blog</a></li>
            
            <li><a href="/tags/data-science">data-science</a></li>
            
            <li><a href="/tags/python">python</a></li>
            
            <li><a href="/tags/resume">resume</a></li>
            
            <li><a href="/tags/spark">spark</a></li>
            
        </ul>
    </div>
    

    
</nav>

</div>
<div class="col-md-9 content">

<h1>List of Lists</h1>
<h4>Published 06-18-2019 21:17:24</h4>
<link href="http://grahamflemingthomson.com/css/share.css" rel="stylesheet" type="text/css">


<a class="resp-sharing-button__link" href="mailto:grahamflemingthomson@gmail.com?subject=Hello, Graham" target="_self" rel="noopener" aria-label="">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=false&amp;url=http%3a%2f%2fgrahamflemingthomson.com%2fposts%2flist-of-lists%2f&amp;source=http%3a%2f%2fgrahamflemingthomson.com%2fposts%2flist-of-lists%2f" target="_blank" rel="noopener" aria-label="">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg>
    </div>
  </div>
</a>

<article>
    <p>There are a seemingly infinite number of ways to flatten a list of lists in base Python. By flattening, I mean
reducing the dimension of a list of lists. In numpy it would be something like:</p>

<pre><code class="language-python">import numpy as np

np.arange(1, 13).reshape(4,3)
# array([[ 1,  2,  3],
#       [ 4,  5,  6],
#       [ 7,  8,  9],
#       [10, 11, 12]])

# becomes
np.arange(1, 13).reshape(4,3).reshape(-1)
# array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12])
</code></pre>

<p>But what is the fastest and cleanest way in base Python? If you&rsquo;ve ever Googled this topic, you&rsquo;ve likely come across
<a href="https://stackoverflow.com/questions/952914/how-to-make-a-flat-list-out-of-list-of-lists">this StackOverflow post</a>
that was asked <em>10 years ago</em> but has answers as new as last year (2018).</p>

<p>So let&rsquo;s start by creating a small list of lists.</p>

<pre><code class="language-python">lol = [list(word) for word in &quot;flatten this list of lists&quot;.split()]
&quot;&quot;&quot;
[['f', 'l', 'a', 't', 't', 'e', 'n'],
 ['t', 'h', 'i', 's'],
 ['l', 'i', 's', 't'],
 ['o', 'f'],
 ['l', 'i', 's', 't', 's']]
&quot;&quot;&quot;
</code></pre>

<p>Now, the novice way of doing this would be to instantiate a new empty list, then use a nested for loop to iterate
through the list of lists and append each string/character to the empty list.</p>

<pre><code class="language-python">empty_list = []
for sublist in lol:
    for char in sublist:
        empty_list.append(char)
# 2.61 µs ± 86.4 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</code></pre>

<p>Pretty from a readability standpoint but inefficient and pretty slow at 2.61 microseconds per loop.</p>

<p>Now we could do the same thing with a comprehension. A bit less readable but still requires no imports and is a bit
faster at 1.22 microseconds per loop.</p>

<pre><code class="language-python">[char for sublist in lol for char in sublist]
# 1.22 µs ± 23.5 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</code></pre>

<p>For those of you who&rsquo;ve been using Python for some time, may remember in Python2, reduce was a built in function.
You could do things like sum the digits from 1 - 9 by doing: <code>reduce(lambda x, y: x + y, range(10))</code>. This was moved
to the functools library in <a href="https://www.python.org/dev/peps/pep-3100/">PEP-3100</a>
because &ldquo;a loop is more readable most of the times&rdquo;. While I agree in most cases, I believe flattening a list of lists
is one of the exceptions.</p>

<pre><code class="language-python"># dont worry, when I was using timeit, I had the imports in separate cells as to not time the import statement
from functools import reduce
from operator import add

reduce(add, lol)
# 728 ns ± 17.2 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</code></pre>

<p>That&rsquo;s it. All we&rsquo;re doing is using <code>add</code> in place of our own anonymous function (e.g. <code>lambda x, y: x + y</code>) and
reducing our list of lists by adding together each of the elements to flatten it. Almost twice as fast as doing this
via a list comprehension and very readable.</p>

<p>Another way is by using the <a href="https://docs.python.org/3/library/operator.html#operator.iconcat">iconcat</a> operator and an
empty list. <code>iconcat</code> is functionally equivalent to doing <code>thing += other_thing</code> but does so &lsquo;in place&rsquo;.</p>

<pre><code class="language-python">from operator import iconcat

reduce(iconcat, lol, [])
# 681 ns ± 35.4 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</code></pre>

<p>Slightly faster (at least at this scale of list size).</p>

<p>One last way is to use chain from itertools and unpack the list as arguments to chain. Like much of itertools, this
returns a generator so we must cast as a list if we want a list returned.</p>

<pre><code class="language-python">from itertools import chain

list(chain(*lol))
# 910 ns ± 30.8 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</code></pre>

<p>For even more detail including how these solutions scale as the size of the list of list gets bigger,
go back to that StackOverflow post and check out
<a href="https://stackoverflow.com/users/353337/nico-schl%c3%b6mer">Nico Schlömer&rsquo;s</a> answer (it isn&rsquo;t the selected answer).
He even provides this pretty time complexity graph:</p>

<p><a href="https://stackoverflow.com/questions/952914/how-to-make-a-flat-list-out-of-list-of-lists"><img src="https://i.stack.imgur.com/ZJrxd.png" alt="image" /></a></p>

</article>



</div>
</div>
<script src="http://grahamflemingthomson.com/js/theme.min.js" type="text/javascript"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-73249319-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


</body>
</html>

